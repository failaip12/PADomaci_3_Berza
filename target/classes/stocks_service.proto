syntax = "proto3";

option java_multiple_files = true;
option java_package = "rs.raf.pds.v5.z2.gRPC";

service StocksService {
	rpc GetUniqueId(Empty) returns (ClientId) {}

	rpc GetStock(StockRequest) returns (Stock) {}

	rpc GetAllStocks(Empty) returns (stream Stock) {}

	rpc SubscribeStocks(SubscribeUpit) returns (stream Stock) {}

	rpc GetOffers(AskBidRequest) returns (stream Offer) {}

	rpc AddOffer(Offer) returns (stream TransactionNotification) {}

	rpc SubToTransactions(ClientId) returns (stream TransactionNotification) {}
}

message Stock {
	string symbol = 1;
	string companyName = 2;
	double startPrice = 3;
	double changeInPrice = 4;
	int64 dateUnix = 5;
}

message SubscribeUpit {
    repeated string symbols = 1;
}

message StockRequest {
    string symbol = 1;
}

message AskBidRequest {
	string symbol = 1;
	int32 numberOfOffers = 2;
	bool ask = 3;
}

message Offer {
	string symbol = 1;
	double stockPrice = 2;
	int32 numberOfOffers = 3;
	bool buy = 4;
	string clientId = 5;
}
message TransactionNotification {
	string clientId = 1;
    string symbol = 2;
    double price = 3;
    int32 numberOfShares = 4;
}
message ClientId {
	string clientId = 1;
}

message Empty {}